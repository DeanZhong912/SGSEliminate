# SGSEliminate
---
## 三国杀消消乐台词脚本
春节活动，游卡又出微信小游戏了，把武将名，技能，台词做成消消乐了，还挺有创意，就台词的关卡有点恶心，卡了好几天了，于是今天就想写一个脚本自动实现，基本功能写出来，一些细节有所不足，如果有大佬看到可以帮忙改进改进。

## 设计思路
1. 从三国杀安装包中"sgs412/assets/res/audio"目录中的skill，victory，dead三个文件中获取音频数据。
2. 调用腾讯云的音频识别ASR，将所有台词识别出来，形成台词数据集。
3. 手机连接电脑，调用adb命令，截图获取屏幕，选取问题区域进行截取。
4. 对截取的部分调用腾讯云文本识别功能OCR，将图片转成一行题目文本。
5. 对得到的题目文本，选取其中两个字组成笛卡尔乘积集合，遍历台词数据集，查找包含两个字组合的台词。组成台词候选，从台词候选集中选取字符全都在题目文本set的台词进行返回得到精确匹配。
6. 使用topK算法，对题目文本在台词库中进行模糊匹配。

## 使用方法
因为用到了腾讯云服务，所以需要注册腾讯云账户,用免费额度，开通ASR,OCR服务，将个人密钥存到CloudKey.txt文件中，并安装腾讯云的依赖包。
1. 运行下面命令，得到台词文本
```
python testTSR.py
```

2. 运行下面命令，得到屏幕截图
```
python test.py
```

3. 运行下面命令，得到截图的目标区域
```
python getInput.py
```

4. 运行下面命令，得到题目文本
```
python testOCR.py
```

5. 运行下面命令，得到消消乐答案的精确解
```
python search.py
```

6. 运行下面命令，得到答案的模糊解
```
python search2.py
```

## 存在问题
语音文本的识别存在有些台词，拼音识别对了，但是字错了，如果有游卡官方的台词库，基本就很容易了。再有就是台词匹配的算法，虽然思路很简单勉强够用，但是我觉得肯定有有好的思路。
目前，已经可以基本实现得到答案的辅助功能，只是台词库中部分台词的拼音转换有误，导致一些台词不能输出，后续把台词人工校正后会上传到仓库，就省去语音识别这一步了。

